(()=>{"use strict";var e={121:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileTreeFormatter=t.FORMAT_MODE=void 0;const o=r(928);var i;!function(e){e[e.TAB=0]="TAB",e[e.LINE=1]="LINE",e[e.KEISEN=2]="KEISEN",e[e.NUM=3]="NUM"}(i||(t.FORMAT_MODE=i={}));let l=[{U___:"    ",UB__:"    ",U_R_:"    ",UBR_:"    ",____:"    "},{U___:"    ",UB__:"|   ",U_R_:" `--",UBR_:"|`--",____:"    "},{U___:"　　",UB__:"│　",U_R_:"└─",UBR_:"├─",____:"　　"}];t.FileTreeFormatter=class{constructor(e){this.fileItems=e,this.rootFolder=e[0],this.rootFolderPath=this.rootFolder.resourceUri.path,this.rootRootFolderPath=o.dirname(this.rootFolderPath),this.rootRetPath=o.relative(this.rootFolderPath,this.rootFolder.resourceUri.path).replace(/\\/g,"/")}exec(e){let t;t="win32"===process.platform?`${this.rootFolderPath.replace(/\//s,"")}/\n`:`${this.rootFolderPath}/\n`;let r=this.fileItems.length,o="",i=[];for(let t=r-1;t>0;t--){let s=this.fileItems[t],a=this.fileItems[t-1],n=this.fileItems[t+1],h=this.pathElemDiff(this.rPath(s),this.rPath(a)),c=[],d=h.length-1;if(n)c=this.pathElemDiff(this.rPath(s),this.rPath(n));else for(let e=0;e<=d;e++)c.push(!1);let p=[],u=[];for(let o=0;o<=d;o++){let s=`${!0===h[o]?"U":"_"}${!0===c[o]?"B":"_"}${o===d?"R":"_"}_`;if(p.push(s),t===r-1)u.push(l[e][p[o]]);else{let t=l[e][p[o]];i[o]===l[e].____&&("UB__"===p[o]?t=l[e].____:("UBR_"===p[o]||"UBR_"===p[o])&&(t=l[e].U_R_)),u.push(t)}}i=u,o=u.join("")+s.label+"\n"+o}return t+o}genPrefixIdx(e,t,r){let o=[],i=this.pathElemDiff(this.rPath(t),this.rPath(e)),l=[],s=i.length-1;if(r)l=this.pathElemDiff(this.rPath(t),this.rPath(r));else for(let e=0;e<=s;e++)l.push(!1);for(let e=0;e<=s;e++){let t=(!0===i[e]?"U":"_")+(!0===l[e]?"B":"_")+(e===s?"R":"_")+"_";o.push(t)}return o}rPath(e){return"./"+o.relative(this.rootFolderPath,e.resourceUri.path).replace(/\\/g,"/")}pathElemDiff(e,t){let r=[],o=e.split("/"),i=t.split("/");for(let e=0;e<o.length-1;e++)i[e]&&o[e]===i[e]?r.push(!0):r.push(!1);return r}countFolderDepth(e){let t=1,r=e.match(/(\\|\/)/g);return null!==r&&(t+=r.length),t}}},353:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewPanelManager=void 0;const o=r(398);t.PreviewPanelManager=class{show(e,t){const r=o.window.createWebviewPanel("treePreview",`Tree from "${t}"`,o.ViewColumn.Beside,{}),i=this.escapeHtml(e);r.webview.html=this.buildHtml(`Tree from: ${this.escapeHtml(t)}`,`<h3>File Tree</h3><pre>${i}</pre>`)}buildHtml(e,t){return`<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="UTF-8" />\n<meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline';">\n<meta name="viewport" content="width=device-width,initial-scale=1" />\n<title>${e}</title>\n<style>\nbody{font-family:var(--vscode-font-family,Arial);padding:12px;line-height:1.4;}\npre{background:var(--vscode-editor-background,#1e1e1e);color:var(--vscode-editor-foreground,#d4d4d4);padding:8px 10px;border-radius:4px;overflow:auto;font-size:12px;}\ncode{font-family:var(--vscode-editor-font-family,Consolas,monospace);}\nh3{margin-top:0;}\n</style>\n</head>\n<body>\n${t}\n</body>\n</html>`}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}}},398:e=>{e.exports=require("vscode")},450:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileItem=t.FileTreeItemsProvider=void 0;const o=r(398),i=r(896);t.FileTreeItemsProvider=class{constructor(e){this._onDidChangeTreeData=new o.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this.workspaceRoots=[],this.workspaceRoots=e}getTreeItem(e){return e}getChildren(e){if(void 0===e){let e=o.TreeItemCollapsibleState.Expanded,t=[];for(let r of this.workspaceRoots)t.push(new l(`\${workspaceRoot} (${r.name})`,r.uri,e));return this.fileTree=t,Promise.resolve(t)}return new Promise(t=>{this.getFiles(e.resourceUri).then(r=>{r=this.sortFileItems(r),e.child=r,t(r)})})}treeCmd(e){let t=[e];if(e.collapsibleState===o.TreeItemCollapsibleState.Expanded)for(let r of e.child)if(r.collapsibleState===o.TreeItemCollapsibleState.Expanded&&r.child.length>0){let e=this.treeCmd(r);t.push(...e)}else t.push(r);return t}refresh(){this._onDidChangeTreeData.fire()}sortFileItems(e){let t=[],r=[],o=[];return e.forEach(e=>{let o=e.resourceUri.fsPath;i.lstatSync(o).isDirectory()?t.push(e):r.push(e)}),t.sort((e,t)=>e.label.localeCompare(t.label)),r.sort((e,t)=>e.label.localeCompare(t.label)),o=t.concat(r),o}getFiles(e){return new Promise(t=>{let r=[];o.workspace.fs.readDirectory(e).then(i=>{i.forEach((t,i,s)=>{let a,n=t[0],h=t[1],c=o.Uri.joinPath(e,n);h===o.FileType.Directory?(a=o.TreeItemCollapsibleState.Collapsed,n+="/"):a=o.TreeItemCollapsibleState.None;let d=new l(n,c,a);r.push(d)}),t(r)})})}pathExists(e){try{i.accessSync(e)}catch(e){return!1}return!0}};class l extends o.TreeItem{constructor(e,t,r){super(e,r),this.label=e,this.resourceUri=t,this.collapsibleState=r,this.child=[]}}t.FileItem=l},896:e=>{e.exports=require("fs")},928:e=>{e.exports=require("path")}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,r),l.exports}var o={};(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.activate=function(e){let r,o=null,a=i.workspace.workspaceFolders;a&&(o=new l.FileTreeItemsProvider(a),r=i.window.createTreeView("fileTree",{showCollapseAll:!1,treeDataProvider:o}),r.onDidCollapseElement(e=>{e.element.collapsibleState=i.TreeItemCollapsibleState.Collapsed}),r.onDidExpandElement(e=>{e.element.collapsibleState=i.TreeItemCollapsibleState.Expanded}));let n=i.commands.registerCommand("tree.cmd",e=>{if(o){let r=o.treeCmd(e),l=new t.FileTreeFormatter(r).exec(t.FORMAT_MODE.KEISEN),a=i.workspace.getConfiguration();"TextEditor"===a?.get("tree.view-type")?i.commands.executeCommand("workbench.action.files.newUntitledFile").then(()=>{!async function(e,t){let r=i.window.activeTextEditor,o=r?.document;o&&(i.languages.setTextDocumentLanguage(o,"markdown"),i.window.activeTextEditor?.edit(r=>{let o=new i.Position(0,0),l=`# Tree View\n## Root path: \n${t}\n\n## Content\n\`\`\`bash\n${e}\n\`\`\`\n`;r.insert(o,l)}))}(l.trimEnd(),e.resourceUri.fsPath)}):(a?.get("tree.view-type"),(new s.PreviewPanelManager).show(l,e.resourceUri.path))}else i.window.showInformationMessage("Open a folder or workspace to use Tree view.")});e.subscriptions.push(n),n=i.commands.registerCommand("tree.refreshEntry",()=>o?.refresh()),e.subscriptions.push(n)},e.deactivate=function(){};const t=r(121),i=r(398),l=r(450),s=r(353)})(),module.exports=o})();